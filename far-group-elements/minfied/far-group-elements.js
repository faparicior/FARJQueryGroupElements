(function(b,c,d){var a={init:function(e){return this.each(function(){var h=$.extend(true,$.fn.adminGroupLists.defaults,e);h.$content_el=$(this);h.id_container=$(this).attr("id");$(this).data("settings",$.extend(true,{},h));a.createElements(h,"far_master_elements",1);a.createElements(h,"far_elements",2);a.createElements(h,"far_free_elements",3);var f=h.$content_el.find("ul");var g=f.filter(".far_master_elements");var j=f.filter(".far_elements");var i=f.filter(".far_free_elements");f.on("keypress",".far_display",a.interceptKeys);f.on("keyup",".far_display",a.interceptEscKeys);g.on("click","li",a.masterSelected);j.on("click","li",a.elementsSelected);i.on("click","li",a.freeElementsSelected);g.on("click focus","li",a.selectChildCategories);f.on("click",".far_display-edit",a.editElement);f.on("focusout",".far_display",a.uneditElement);g.on("click",".newElementMaster",a.newElementMaster);j.on("click",".newElement",a.newElement);i.on("click",".newElementFree",a.newFreeElement);i.on("click",".far_display-tag",a.assignElement);g.on("click",".close-element",a.removeMasterElement);j.on("click",".close-element",a.removeElement);i.on("click",".close-element",a.removeFreeElement)})},masterSelected:function(){var e=$(this);var j=e.closest(".far-admin-groups");var f=e.closest("ul");var i=e.data("uid");var h=j.find(".far_elements").find("li").filter(".newElement");var g=j.find(".far_elements").find("li");f.attr("data-id-selected",i);f.find(".elementSelected").removeClass("elementSelected");g.filter(".elementSelected").removeClass("elementSelected");e.addClass("elementSelected");h.show()},elementsSelected:function(){var e=$(this);e.closest("ul").find(".elementSelected").removeClass("elementSelected");e.addClass("elementSelected")},freeElementsSelected:function(){var e=$(this);e.closest("ul").find(".elementSelected").removeClass("elementSelected");e.addClass("elementSelected")},selectChildCategories:function(){var e=$(this);var i=e.closest(".far-admin-groups");var h=e.closest("ul");var f=i.find(".far_elements").find("li");var g=e.data("uid");h.attr("data-id-selected",g);f.not('[data-relid = "'+g+'"]').not(".newElement").hide();f.filter('[data-relid = "'+g+'"]').show()},editElement:function(){var e=$(this).closest("li").find(".far_display");e.attr("contenteditable","true");e.focusin();a.selectText(e)},uneditElement:function(){$(this).attr("contenteditable","false")},assignElement:function(){var e=$(this).closest("li");var h=e.closest(".far-admin-groups");var g=h.find(".far_master_elements").attr("data-id-selected");if(g){var f=e.detach();f.find(".far_display-tag").remove();f.attr("data-relid",g);h.find(".far_elements").find(".newElement").closest("li").before(f)}},newElementMaster:function(g){var k=a.getClassesExtra(g.target);var m=a.getTemplates(g.target);var h=a.template_li_new_item(1,m,k,false);var f=$(m.edit_element);var e=$(m.close_element);var j=a.generateUUID();var n=$(this).closest("li");var i=$(this).closest("ul");var l=$(this).find(".far_display");n.removeClass("newElementMaster");n.attr("data-uid",j);i.attr("data-id-selected",j);l.after(e);l.after(f);a.selectText(l);n.after(h)},newElement:function(h){var l=a.getClassesExtra(h.target);var o=a.getTemplates(h.target);var i=a.template_li_new_item(2,o,l,false);var g=$(o.edit_element);var f=$(o.close_element);var k=a.generateUUID();var p=$(this).closest("li");var e=p.closest(".far-admin-groups");var m=e.find("ul").filter(".far_master_elements");var n=$(this).find(".far_display");p.removeClass("newElement");$(this).attr("data-uid",k);var j=m.attr("data-id-selected");p.attr("data-relid",j);n.after(f);n.after(g);a.selectText(n);n.closest("li").after(i)},newFreeElement:function(h){var k=a.getClassesExtra(h.target);var m=a.getTemplates(h.target);var i=a.template_li_new_item(3,m,k,false);var g=$(m.edit_element);var f=$(m.close_element);var e=$(m.assign_element);var j=a.generateUUID();var n=$(this).closest("li");var l=$(this).find(".far_display");n.removeClass("newElementFree");$(this).attr("data-uid",j);l.before(e);l.after(f);l.after(g);a.selectText(l);n.after(i)},getClassesExtra:function(e){var f=$(e).closest(".far-admin-groups").data("settings");return f.classes},getTemplates:function(e){var f=$(e).closest(".far-admin-groups").data("settings");return f.template},removeElement:function(h){var g=a.getTemplates(h.target);var e=$(this).closest("li");var j=e.closest(".far-admin-groups");var i=e.detach();var f=$(g.assign_element);i.find(".far_display").removeAttr("data-relid");i.find(".far_display").before(f);j.find(".far_free_elements").find(".newElementFree").closest("li").before(i)},removeFreeElement:function(){$(this).closest("li").remove()},removeMasterElement:function(h){var n=a.getTemplates(h.target);var k=$(this).closest("li");var f=k.attr("data-uid");var e=k.closest(".far-admin-groups");var i=k.closest("ul");var j=i.attr("data-id-selected");var o=e.find(".far_elements").find("li");var m=o.filter('[data-relid = "'+f+'"]');var l=o.filter(".newElement");var g=e.find(".far_free_elements");m.prepend($(n.assign_element));m.detach();if(f==j){i.removeAttr("data-id-selected");l.hide()}g.find("li").filter(".newElementFree").before(m);k.remove()},template_li_master:function(e,g,f){return $('<li data-uid="'+e.id+'"><span class="far_display" " contenteditable="false">'+e.desc+"</span>"+g.edit_element+g.close_element+"</li>").addClass(f.li_master)},template_li:function(e,g,f){return $('<li data-uid="'+e.id+'" data-relid="'+e.relId+'" style="display: none;"><span class="far_display" contenteditable="false">'+e.desc+"</span>"+g.edit_element+g.close_element+"</li>").addClass(f.li_element)},template_li_free:function(e,g,f){return $('<li data-uid="'+e.id+'">'+g.assign_element+'<span class="far_display" contenteditable="false">'+e.desc+"</span>"+g.edit_element+g.close_element+"</li>").addClass(f.li_free_element)},template_li_new_item:function(e,g,f,h){if(e==1){return $('<li class="newElementMaster">'+g.new_element+"</li>").addClass(f.li_master)}else{if(e==2){if(h){return $('<li class="newElement" style="display: none;">'+g.new_element+"</li>").addClass(f.li_new_element)}else{return $('<li class="newElement">'+g.new_element+"</li>").addClass(f.li_new_element)}}else{return $('<li class="newElementFree">'+g.new_element+"</li>").addClass(f.li_free_element)}}},template_ul:function(e){return $('<ul class="'+e+'"></<ul>')},createElements:function(i,j,h){var g=i.classes;var f=i.template;var k=i.values[j];var e=i.$content_el.find("."+j);if(!e.length){e=a.template_ul(j);e.appendTo("#"+i.id_container)}$.each(k,function(l,m){if(h==1){a.template_li_master(m,f,g).appendTo(e)}else{if(h==2){a.template_li(m,f,g).appendTo(e)}else{a.template_li_free(m,f,g).appendTo(e)}}});if(h==2){a.template_li_new_item(h,f,g,true).appendTo(e)}else{a.template_li_new_item(h,f,g,false).appendTo(e)}},getAllElements:function(){var f=$(this).data("settings");var e=$("#"+f.id_container);var g={};g.far_master_elements=a.getElements(e,".far_master_elements",".newElementMaster");g.far_free_elements=a.getElements(e,".far_free_elements",".newElementFree");g.far_elements=a.getElements(e,".far_elements",".newElement");return g},getElements:function(f,j,e){var h=[];var g=f.find(j);var i=g.find("li").not(e);i.each(function(){var k={};k.id=$(this).attr("data-uid");k.desc=$(this).find(".far_display").text();h.push(k)});return h},generateUUID:function(){var f=new Date().getTime();var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=(f+Math.random()*16)%16|0;f=Math.floor(f/16);return(h=="x"?g:(g&3|8)).toString(16)});return e},selectText:function(h){var i=document;var f=h[0];if(i.body.createTextRange){var e=document.body.createTextRange();e.moveToElementText(f);e.select()}else{if(b.getSelection){var g=b.getSelection();var e=document.createRange();e.selectNodeContents(f);g.removeAllRanges();g.addRange(e)}}},deselectText:function(){if(document.selection){document.selection.empty()}else{if(b.getSelection){b.getSelection().removeAllRanges()}}},interceptKeys:function(f){if(f.keyCode==13){$(f.target).removeAttr("contenteditable")}return f.which!=13},interceptEscKeys:function(f){if(f.keyCode==27){document.execCommand("Undo",false,0);a.deselectText();$(f.target).removeAttr("contenteditable")}}};$.fn.adminGroupLists=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{$.error("Method "+e+" does not exist on jQuery.adminGroupLists")}}};$.fn.adminGroupLists.defaults={version:"1.0",id_container:"demo",template:{new_element:'<span class="far_display" contenteditable="true">Add new</span>',edit_element:'<span class="fa fa-pencil far_display-edit"></span>',close_element:'<span class="fa fa-times far_display-close close-element"></span>',assign_element:'<span class="fa fa-tag far_display-tag"></span>'},classes:{li_master:"",li_element:"",li_free_element:"",li_new_element:""},values:{far_master_elements:[{id:"1",desc:"Markets"},{id:"4",desc:"Professional services"},{id:"5",desc:"Health"}],far_free_elements:[{id:"7",desc:"Pharmacy"},{id:"8",desc:"Optics"},{id:"9",desc:"Shoes"}],far_elements:[{id:"1",desc:"Supermarket",relId:"1"},{id:"4",desc:"Fruit Store",relId:"1"},{id:"5",desc:"Hardware",relId:"4"}]}}})(window,jQuery);